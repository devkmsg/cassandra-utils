#!/usr/bin/env ruby
require_relative '../lib/cassandra/utils'
require 'thor'

class CassandraUtils < Thor

  class_option :loop_sleep_time, type: :numeric,
    required: true, default: 120,
    desc: 'Frequency tasks are run'
  desc 'util', 'Perform various utilities'
  def util
    s = ::Cassandra::Utils::Daemon.new(options)
    s.start!
  end
  # Backwards compatibility
  desc 'stats', '[DEPRECATED - Use util] Write metrics to Datadog'
  def stats
    send(:util)
  end
end

CassandraUtils.start
